---
- import_tasks: apt.yml
  when: ansible_distribution == 'Ubuntu'
  tags: apt

- import_tasks: sshd_config.yml
  when: ansible_distribution == 'Ubuntu'
  tags: sshd_config

- name: Deactivate Diffie-Hellman moduli less than 3072-bit long
  shell: awk '$5 >= 3071' /etc/ssh/moduli > /etc/ssh/moduli.tmp && mv /etc/ssh/moduli.tmp /etc/ssh/moduli

- import_tasks: create_user.yml
  when: ansible_distribution == 'Ubuntu'
  tags: create_user

- import_tasks: set_user_ssh_key.yml
  when: ansible_distribution == 'Ubuntu'
  tags: set_user_ssh_key
